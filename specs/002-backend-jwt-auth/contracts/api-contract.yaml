# Todo App API Contract

## Base URL
`/api`

## Authentication
All endpoints (except auth endpoints) require a valid JWT token in the Authorization header:
```
Authorization: Bearer <token>
```

## Common Response Formats

### Success Response
```json
{
  "success": true,
  "data": {},
  "message": "optional message"
}
```

### Error Response
```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "Human readable message"
  }
}
```

## Task Management Endpoints

### GET /tasks
Retrieve all tasks for the authenticated user.

#### Query Parameters
- `status`: Optional. Values: "all", "pending", "completed". Default: "all"

#### Response Codes
- 200: Success
- 401: Unauthorized (invalid/missing JWT)

#### Response Body (200)
```json
{
  "success": true,
  "data": {
    "tasks": [
      {
        "id": 1,
        "user_id": "user-uuid",
        "title": "Task title",
        "description": "Task description",
        "completed": false,
        "created_at": "2023-01-01T00:00:00Z",
        "updated_at": "2023-01-01T00:00:00Z"
      }
    ]
  },
  "message": "Tasks retrieved successfully"
}
```

### POST /tasks
Create a new task for the authenticated user.

#### Request Body
```json
{
  "title": "Task title",
  "description": "Task description (optional)"
}
```

#### Response Codes
- 201: Created
- 400: Bad Request (validation error)
- 401: Unauthorized (invalid/missing JWT)

#### Response Body (201)
```json
{
  "success": true,
  "data": {
    "id": 1,
    "user_id": "user-uuid",
    "title": "Task title",
    "description": "Task description",
    "completed": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  },
  "message": "Task created successfully"
}
```

### GET /tasks/{id}
Retrieve a specific task for the authenticated user.

#### Path Parameters
- `id`: Task ID (integer)

#### Response Codes
- 200: Success
- 401: Unauthorized (invalid/missing JWT)
- 403: Forbidden (user doesn't own task)
- 404: Not Found (task doesn't exist)

#### Response Body (200)
```json
{
  "success": true,
  "data": {
    "id": 1,
    "user_id": "user-uuid",
    "title": "Task title",
    "description": "Task description",
    "completed": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-01T00:00:00Z"
  },
  "message": "Task retrieved successfully"
}
```

### PUT /tasks/{id}
Update a specific task for the authenticated user.

#### Path Parameters
- `id`: Task ID (integer)

#### Request Body
```json
{
  "title": "Updated task title",
  "description": "Updated task description (optional)"
}
```

#### Response Codes
- 200: Success
- 400: Bad Request (validation error)
- 401: Unauthorized (invalid/missing JWT)
- 403: Forbidden (user doesn't own task)
- 404: Not Found (task doesn't exist)

#### Response Body (200)
```json
{
  "success": true,
  "data": {
    "id": 1,
    "user_id": "user-uuid",
    "title": "Updated task title",
    "description": "Updated task description",
    "completed": false,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-02T00:00:00Z"
  },
  "message": "Task updated successfully"
}
```

### DELETE /tasks/{id}
Delete a specific task for the authenticated user.

#### Path Parameters
- `id`: Task ID (integer)

#### Response Codes
- 200: Success
- 204: No Content (success with no response body)
- 401: Unauthorized (invalid/missing JWT)
- 403: Forbidden (user doesn't own task)
- 404: Not Found (task doesn't exist)

### PATCH /tasks/{id}/complete
Toggle the completion status of a specific task for the authenticated user.

#### Path Parameters
- `id`: Task ID (integer)

#### Request Body
```json
{
  "completed": true
}
```

#### Response Codes
- 200: Success
- 400: Bad Request (validation error)
- 401: Unauthorized (invalid/missing JWT)
- 403: Forbidden (user doesn't own task)
- 404: Not Found (task doesn't exist)

#### Response Body (200)
```json
{
  "success": true,
  "data": {
    "id": 1,
    "user_id": "user-uuid",
    "title": "Task title",
    "description": "Task description",
    "completed": true,
    "created_at": "2023-01-01T00:00:00Z",
    "updated_at": "2023-01-02T00:00:00Z"
  },
  "message": "Task completion status updated successfully"
}
```